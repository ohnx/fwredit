<!DOCTYPE html>
<html lang="en">
<head>
<title>Minimal broken example</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
</head>
  <body>
    <div>Minimal broken example</div>
    <!-- js codes -->
    <script>
      var defaultModule = {
        onRuntimeInitialized: function() {
          console.log('Loaded user code! Running now...');
      
          // run the code
          Module.GlueCode_setupAndRun();
        }
      };
      
      var Module = Object.assign({}, defaultModule);

      let loadScript = function(url, callback) {
        if (!url) return;
        // Adding the script tag to the head as suggested before
        var head = document.head;
        var script = document.createElement('script');
        script.type = 'text/javascript';
        script.src = url;
        var elemId = 'whatever';
        script.id = elemId;
      
        // Then bind the event to the callback function.
        // There are several events for cross browser compatibility.
        script.onreadystatechange = function() {callback(elemId);};
        script.onload = function() {callback(elemId);};
      
        // Fire the loading
        head.appendChild(script);
      };
      
      loadScript("minimal.js");
    </script>
  </body>
</html>
